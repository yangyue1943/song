package com.studio.api.controller;import com.song.net.http.HttpFile;import com.song.toolkit.http.HttpFileRequest;import com.studio.common.result.UploaderFile;import com.studio.common.result.UploaderResult;import com.studio.common.result.ViewResult;import org.apache.commons.fileupload.FileUploadException;import org.slf4j.Logger;import org.slf4j.LoggerFactory;import org.springframework.stereotype.Controller;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.RequestMethod;import org.springframework.web.bind.annotation.ResponseBody;import javax.servlet.http.HttpServletRequest;import javax.servlet.http.HttpServletResponse;import java.io.IOException;import java.util.Map;/** * description: * author:          song * createDate:      2018/1/24 */@Controller@RequestMapping("/uploader")public class UploaderController {    protected final static Logger logger = LoggerFactory.getLogger(UploaderController.class);    @ResponseBody    @RequestMapping(value = "upload",method = RequestMethod.POST)    public UploaderResult upload(HttpServletRequest request, HttpServletResponse response) {        UploaderResult result = new UploaderResult();        /*InputStreamReader reader = new InputStreamReader(item.getInputStream());        BufferedReader br = new BufferedReader(reader);        String str;        while ((str = br.readLine()) != null) {            if(!StringHelper.isEmpty(str)){            }        }*/        try {            String savePath="D:\\\\testfilex\\\\";            HttpFileRequest fileRequest = new HttpFileRequest(request);            Map<String, HttpFile> fileMap= fileRequest.batchSave(savePath);            for (Map.Entry<String, HttpFile> entry : fileMap.entrySet()) {                HttpFile httpFile=entry.getValue();                UploaderFile uploaderFile = new UploaderFile();                uploaderFile.setName(entry.getKey());                uploaderFile.setPath(httpFile.getFilePath());                uploaderFile.setSize(httpFile.getSize());                uploaderFile.setExt(httpFile.getExtension());                uploaderFile.setRealName(httpFile.getFileName());                result.addFile(uploaderFile);            }        } catch (IOException e) {            result.setSuccess(false);            logger.error("上传文件错误:", e);        } catch (FileUploadException e) {            result.setSuccess(false);            logger.error("上传文件错误:", e);        }        return result;    }    @ResponseBody    @RequestMapping(value = "remove", method = RequestMethod.POST)    public ViewResult remove(String id) {        ViewResult result = new ViewResult();        return result;    }}