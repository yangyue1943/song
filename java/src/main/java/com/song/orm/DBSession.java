package com.song.orm;import com.song.db.DBClient;import com.song.db.DBConnectionConfig;import com.song.db.DBHelper;import com.song.db.DBType;import com.song.orm.adapter.IDataAdapter;import com.song.orm.adapter.ResultSetAdapter;import java.sql.ResultSet;import java.sql.SQLException;import java.util.List;import java.util.Map;/** * description: * author:          song * createDate:      2017/10/29 */public class DBSession extends DBClient {    public DBSession(String configPath) throws Exception {        super(configPath);    }    public DBSession(DBType type, String url, String userName, String password) throws Exception {        super(type, url, userName, password);    }    public DBSession(DBConnectionConfig connectionConfig) throws Exception {        super(connectionConfig);    }    public List<Map<String, Object>> toListMap(String sql, List<Object> paramters) throws SQLException {        ResultSet resultSet = this.executeQuery(sql, paramters);        try {            IDataAdapter adapter = new ResultSetAdapter(resultSet);            return adapter.toListMap();        } finally {            DBHelper.closeResultSet(resultSet);        }    }    public <T> List<T> toList(Class<T> clazz,String sql,List<Object> paramters) throws Exception {        ResultSet resultSet = this.executeQuery(sql, paramters);        try {            IDataAdapter adapter = new ResultSetAdapter(resultSet);            return adapter.toList(clazz);        } finally {            DBHelper.closeResultSet(resultSet);        }    }}